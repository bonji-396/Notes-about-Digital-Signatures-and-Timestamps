# 長期署名

デジタル署名の有効期限が切れると電子証明書が失効状態となります。
そのため、長期間にわたってデジタルデータの真正性を保証するための長期署名という形式があります。

特に企業や政府機関で必要とされる法的文書や契約書など、時間が経過してもその有効性を保持する必要がある文書に対して使用されます。ここでは、長期署名の主要な要素とその仕組みについてまとめます。

## デジタル署名の有効期限

デジタル署名の有効期限は、署名に使用されるデジタル証明書の有効期限に依存します。一般的には、デジタル証明書の有効期限は 2〜3 年で、有効期限が切れると電子証明書が失効状態となります。

しかし、署名の有効性は証明書の有効期限後も確認できる場合があります。これは、署名が作成された時点での証明書の状態を保持し、それを基に署名の検証を行うためです。したがって、過去に署名された PDF ファイルのデジタル署名は、証明書の有効期限後も検証可能な場合があります。

## デジタル署名が有効期限以降は検証できなくなるのか？

過去に署名された PDF ファイルのデジタル署名について、その有効期限が過ぎた後も検証可能かどうかは、PDF がどのように署名されているかによります。

署名された PDF ファイルは、適切な検証データが含まれている場合、証明書の有効期限後も検証が行えることが多いです。ただし、この機能をフルに利用するためには、署名時に適切な設定が施されている必要があります。

### タイムスタンプが施されていれば、署名自体が署名時に有効であった場合は検証は可能

一般的に、デジタル署名に使用される証明書の有効期限が切れても、署名自体が署名時に有効であった場合（証明書が有効で、適切な認証局によって発行されていた場合）、署名の検証は引き続き可能です。

この時、タイムスタンプ自体の有効期限が切れていても、署名された時点で有効であった記録（タイムスタンプが証明する証明書の有効性）が保持されていれば、文書の署名は依然として有効と見なされることが一般的です。

### PAdES 形式で署名すれば、署名に検証情報を付与するので検証が可能

PAdES では、署名に関連するすべての検証データ（証明書、失効情報、タイムスタンプなど）を文書に含めることができ、これにより長期間にわたって署名を検証することが可能です。

## 長期署名の役割

タイムスタンプとそれに関連する証明書の状況を定期的に評価し、必要に応じて新しいタイムスタンプを文書に適用することが推奨されます。これにより、文書の信頼性を長期にわたって維持することが可能です。署名の長期的な検証を目的とした場合、特に PAdES-LTA（PDF Advanced Electronic Signatures - Long Term with Archiving）のような規格を採用することで、タイムスタンプの再適用などを通じて、文書の信頼性を確保するための手段が提供されます。

## 長期署名の主要な要素

1. **デジタル署名**:

   - 文書またはデータに対して行われる通常のデジタル署名です。これにより、文書が署名された時点のデータの完全性と非改ざんが保証されます。

2. **タイムスタンプ**:

   - 署名された文書またはデータにタイムスタンプを追加することで、署名がなされた正確な日時が記録されます。これは、証明書の有効期限が切れた後も文書の検証を可能にするために重要です。

3. **証明書と失効情報**:
   - 署名に使用された証明書と、その証明書の失効リスト（CRL）またはオンライン証明書状態プロトコル（OCSP）応答が含まれます。これにより、将来的にも証明書がその時点で有効だったことが証明できます。

## 長期署名の利点

- **信頼性の向上**:

  - 長期署名により、文書の署名が法的にも技術的にも長期間にわたってその信頼性を保つことができます。

- **法的遵守**:

  - 多くの法的要件では、文書が長期間にわたってその真正性を保つことが求められており、長期署名はこれを満たす手段を提供します。

- **アーカイブの効率化**:
  - 法的または規制上の理由から長期間保存が必要な文書の管理を効率的に行うことができます。

## 実装と標準

長期署名の実装には、PAdES (PDF Advanced Electronic Signatures) や XAdES (XML Advanced Electronic Signatures) などの規格があり、これらはそれぞれ PDF ファイルや XML データの署名に適した形式を提供しています。これらの規格は、文書の長期保存と検証のための枠組みを標準化し、国際的に広く認められた方法でデジタル署名の実践を支援します。

長期署名は、その証明書の管理や更新、タイムスタンプの追加など、適切なメンテナンスが必要ですが、これによりデジタルデータの信頼性とセキュリティが大幅に向上します。

## 電子署名が提供するセキュリティレベルとその有効期限を管理するための要件

| 種類               | 説明                                                                                                                                                  | 有効期限                      | 有効延長タイムスタンプによる延長の可否 |
| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------- | -------------------------------------- |
| 通常署名           | タイムスタンプ無しの電子署名（証明書有効期間内の利用）                                                                                                | 通常 1 ～ 3 年程度、最大 5 年 | ×                                      |
| PAdES-Basic        | 通常署名とタイムスタンプがセットになった署名（証明書有効期間以上の長期保管用）                                                                        | 延長可能                      | ○                                      |
| PAdES-Enhanced     | PAdES-Basic よりセキュリティーの高い CAdES とタイムスタンプがセットになった新しい長期署名                                                             | 延長可能                      | ○                                      |
| PAdES-LTV          | 長期署名の有効期間延長タイムスタンプ<br>既存の長期署名（PAdES-Basic または PAdES-Enhanced）に重ねて付与することで、署名の有効期限を延長することが可能 | 延長可能                      | ○                                      |
| PAdES-DocTimeStamp | タイムスタンプのみ付与する PAdES 署名                                                                                                                 | 延長可能                      | ○                                      |

https://www.skycom.jp/topicword/pades/

https://www.jnsa.org/result/e-signature/data/e-signature-guideline_v1.0_20210331.pdf
